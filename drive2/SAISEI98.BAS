100 ' LIST 1
110 WIDTH 40,25:CONSOLE 0,25,0,1:DEFINT A-Z    ' PC-9801 ¶ÞÒÝ ¼®·¶
120 SCREEN 3:CLS 3:DIM M(20,12),O(32,4)        ' 640*400 ¶×°¥Ó°ÄÞ
130 GOSUB *MAPPUT
140 *INIT
150 MX=RND(1)*19:MY=RND(1)*11:IF M(MX,MY)<>0 THEN 140
160 *MAIN
170 GOSUB *MMOV
180 GOSUB *OCAL
190 FOR T=0 TO 200:NEXT         ' ³ª²Ä (µ¿² Ï¼Ý Ê 200 ¦ Á²»¸¼Ã¸ÀÞ»²¡)
200 GOTO *MAIN
210 *MMOV                       ' ¼Þ·¬× ²ÄÞ³
220 M=0:N=0:I0=INP(&HE0):I1=INP(&HE1):I2=INP(&HE8):I3=INP(&HEA)
230 IF(I1=254 OR I2=253)AND(MY>0)THEN N=N-1:GOTO 280
240 IF(I0=251 OR I3=253)AND(MY<11)THEN N=N+1:GOTO 280
250 IF(I0=239 OR I3=251)AND(MX>0)THEN M=M-1:GOTO 280
260 IF(I0=191 OR I2=251)AND(MX<19)THEN M=M+1:GOTO 280
270 GOTO *MMVSTEP
280 IF M(MX+M,MY+N)=7 THEN GOTO *MMVSTEP
290 GOSUB *MCLR
300 MX=MX+M:MY=MY+N
310 IF M(MX,MY)=2 THEN GOSUB *OSET
320 *MMVSTEP
330 GOSUB *MPUT
340 RETURN
350 *MCLR                       ' ¼Þ·¬× ¸Ø±
360 LOCATE MX*2,MY*2  :PRINT "  ";
370 LOCATE MX*2,MY*2+1:PRINT "  ";
380 RETURN
390 *MPUT                       ' ¼Þ·¬× Ë®³¼Þ
400 COLOR 7
410 LOCATE MX*2,MY*2  :PRINT "qp";
420 LOCATE MX*2,MY*2+1:PRINT "vv";
430 RETURN
440 *OSET                       ' µÌÞ¼Þª¸Ä ¾¯Ä
450 O=0
460 IF O(O,0)=0 THEN 490
470 O=O+1:IF O<32 THEN 460
480 RETURN
490 M(MX,MY)=0:LINE(MX*32,MY*32)-(MX*32+31,MY*32+31),0,BF
500 O(O,0)=1:O(O,1)=0:O(O,2)=MX:O(O,3)=MY:RETURN
510 *OCAL
520 FOR O=0 TO 31
530  IF O(O,0)<>0 THEN GOSUB *OMOV
540 NEXT O
550 RETURN
560 *OMOV                        ' µÌÞ¼Þª¸Ä º°Ù
570 OX=O(O,2)*32+15:OY=O(O,3)*32+15:OS=O(O,1)
580 LINE(OX-OS,OY-OS)-(OX+OS+1,OY+OS+1),2,BF
590 O(O,1)=O(O,1)+1:IF O(O,1)>15 THEN O(O,0)=0:M(O(O,2),O(O,3))=2
600 RETURN
610 ' ¶ÍÞ Ë®³¼Þ
620 *MAPPUT
630 RESTORE *MDAT
640  FOR I=0 TO 11
650   FOR J=0 TO 19
660    READ M:M(J,I)=M
670    LINE(J*32,I*32)-(J*32+31,I*32+31),M,BF
680   NEXT J
690  NEXT I
700 RETURN
710 *MDAT
720 DATA 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
730 DATA 7,0,2,2,2,2,2,0,0,7,7,0,0,2,2,2,2,2,0,7
740 DATA 7,0,7,7,7,7,7,0,0,7,7,0,0,7,7,7,7,7,0,7
750 DATA 7,0,7,2,2,2,2,0,0,7,7,0,0,2,2,2,2,7,0,7
760 DATA 7,0,7,2,2,2,2,0,0,7,7,0,0,2,2,2,2,7,0,7
770 DATA 7,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,7
780 DATA 7,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,7
790 DATA 7,0,7,2,2,2,2,0,0,7,7,0,0,2,2,2,2,7,0,7
800 DATA 7,0,7,2,2,2,2,0,0,7,7,0,0,2,2,2,2,7,0,7
810 DATA 7,0,7,7,7,7,7,0,0,7,7,0,0,7,7,7,7,7,0,7
820 DATA 7,0,2,2,2,2,2,0,0,7,7,0,0,2,2,2,2,2,0,7
830 DATA 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
