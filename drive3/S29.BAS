100 CLS:PRINT "¼Þ­³¼®Û¸ É Ì§²Ù Ò² Ê?"
110 PRINT:LINE INPUT F$
120 IF F$="" THEN 100
130 OPEN F$ AS #1
140 FIELD #1, 30 AS NAM$, 20 AS TEL$, 50 AS ADR$
150 *MENU
160 PRINT:PRINT
170 PRINT "<<ÒÆ­°>>":PRINT
180 PRINT " ¹Ý»¸ / ¼­³¾² : 1"
190 PRINT " ±À×¼¸ Ä³Û¸   : 2"
200 PRINT " µÜØ          : 0"
210 PRINT:PRINT "¿³» ¦ ÊÞÝºÞ³ ÃÞ ¾ÝÀ¸ ¼Ã ¸ÀÞ»² ";
220 Q$=INPUT$(1):PRINT Q$
230 ON VAL(Q$)+1 GOTO *EXIT,*INNAME,*NEWENTRY
240 GOTO *MENU
250 *INNAME
260 IF LOF(1)<>0 THEN 330
270 PRINT:PRINT F$+" ÆÊ ÃÞ°À ¶Þ ±ØÏ¾Ý"
280 PRINT:PRINT "±À×¼¸ Ä³Û¸ ¼Ï½¶? (Y/N) ";
290 Q$=INKEY$:IF Q$="" THEN GOTO 290
300 IF Q$="N" OR Q$="n" THEN GOTO *MENU
310 IF Q$="Y" OR Q$="y" THEN GOTO *NEWENTRY
320 GOTO 290
330 NH=1
340 PRINT:PRINT "»¶Þ½ ÅÏ´ Ê?":PRINT:INPUT "ÅÏ´:";HNAM$
350 IF HNAM$="" THEN *MENU
360 HL=LEN(HNAM$)
370 IF NH>LOF(1) THEN PRINT:PRINT "¿É ÅÏ´ Ê Ä³Û¸ »ÚÃ ²Ï¾Ý":GOTO *MENU
380 GET #1,NH
390 IF HNAM$<>LEFT$(NAM$,HL) THEN NH=NH+1:GOTO 370
400 PRINT:PRINT "ÅÏ´: ";NAM$
410 PRINT "TEL: ";TEL$
420 PRINT "¼Þ­³¼®: ";ADR$
430 PRINT:PRINT "¼­³¾² ¼Ï½¶? (Y/N) ";
440 Q$=INKEY$:IF Q$="" THEN GOTO 440
450 IF Q$="N" OR Q$="n" THEN PRINT "N":GOTO *MENU
460 IF Q$="Y" OR Q$="y" THEN PRINT "Y":GOTO *CHANGE
470 GOTO 440
480 *CHANGE
490 PRINT:PRINT "ØÀ°Ý ·° ÀÞ¹ µ½Ä ¿É º³Ó¸ Ê ¼­³¾² »ÚÏ¾Ý"
500 DNAM$="":DTEL$="":DADR$=""
510 PRINT:INPUT "ÅÏ´";DNAM$
520 IF DNAM$<>"" THEN LSET NAM$=DNAM$
530 INPUT "TEL";DTEL$
540 IF DTEL$<>"" THEN LSET TEL$=DTEL$
550 INPUT "¼Þ­³¼®";DADR$
560 IF DADR$<>"" THEN LSET ADR$=DADR$
570 PUT #1,NH:GOTO *MENU
580 *NEWENTRY
590 PRINT:PRINT "±À×¼¸ Ä³Û¸ ¼Ï½"
600 NH=LOF(1)+1
610 PRINT:INPUT "ÅÏ´:";NNAM$
620 IF NNAM$="" THEN *MENU
630 INPUT "TEL:";NTEL$
640 INPUT "¼Þ­³¼®:";NADR$
650 LSET NAM$=NNAM$
660 LSET TEL$=NTEL$
670 LSET ADR$=NADR$
680 PUT #1,NH:GOTO *MENU
690 *EXIT
700 PRINT:PRINT "¼­³Ø®³"
710 CLOSE:END
